<mxfile host="app.diagrams.net" modified="2023-11-03T00:36:50.511Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36" etag="DtxwJNg4bEeZbVXIAsbc" version="21.8.2" type="github">
  <diagram name="第 1 页" id="voQeae59uFrAf403KE_O">
    <mxGraphModel dx="2901" dy="1071" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Xp7Y2SF31okqukY9dUAG-119" value="" style="rounded=1;whiteSpace=wrap;html=1;opacity=30;strokeColor=#000000;strokeWidth=12;" vertex="1" parent="1">
          <mxGeometry x="1000" y="720" width="630" height="480" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-1" target="Xp7Y2SF31okqukY9dUAG-5">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="150" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-1" value="seq: [batch, seq_len]&lt;br&gt;[2, 2048]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-4">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="30" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-4" value="embed: [2, 2048, 896]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="240" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-5" target="Xp7Y2SF31okqukY9dUAG-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-5" target="Xp7Y2SF31okqukY9dUAG-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-5" value="Embedding:&amp;nbsp;&lt;br&gt;[VOCAB, 896]" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="150" width="270" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-6" target="Xp7Y2SF31okqukY9dUAG-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-6" target="Xp7Y2SF31okqukY9dUAG-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-6" value="retrieved: [batch, num_chunks, num_neighbor, chunk_size_with_continuation]&lt;br&gt;[2, 32, 2, 128]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="220" y="80" width="290" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-7" target="Xp7Y2SF31okqukY9dUAG-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-7" value="!= pad_id" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="390" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-8" target="Xp7Y2SF31okqukY9dUAG-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-47" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-8" target="Xp7Y2SF31okqukY9dUAG-34">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="260" />
              <mxPoint x="360" y="785" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-8" value="mask: [2, 32, 2, 128]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="390" y="240" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-12" value="Meta Information" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="620" y="90" width="200" height="240" as="geometry">
            <mxRectangle x="620" y="90" width="130" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-13" value="num_chunks: 2048/64=32" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="Xp7Y2SF31okqukY9dUAG-12">
          <mxGeometry y="30" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-14" value="seq_index = num_seq_chunks * chunk_size = 32*64=2048" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="Xp7Y2SF31okqukY9dUAG-12">
          <mxGeometry y="60" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-82" value="deep_norm = True" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="Xp7Y2SF31okqukY9dUAG-12">
          <mxGeometry y="90" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-83" value="post_norm = True" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="Xp7Y2SF31okqukY9dUAG-12">
          <mxGeometry y="120" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-86" value="decode_depth = 12" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="Xp7Y2SF31okqukY9dUAG-12">
          <mxGeometry y="150" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-84" value="decode_scale_residual=(3 * decode_depth) ^ 0.25" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="Xp7Y2SF31okqukY9dUAG-12">
          <mxGeometry y="180" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-85" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="Xp7Y2SF31okqukY9dUAG-12">
          <mxGeometry y="210" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-18" target="Xp7Y2SF31okqukY9dUAG-34">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-18" value="retrieved: [2, 32, 2, 128, 896]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="230" y="240" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-23" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-21" target="Xp7Y2SF31okqukY9dUAG-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-21" value="arrange(seq_len)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-120" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-22" target="Xp7Y2SF31okqukY9dUAG-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-22" value="Embedding:&amp;nbsp;&lt;br&gt;[max_seq_len, 896]" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-160" y="150" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-28" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-24" target="Xp7Y2SF31okqukY9dUAG-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-24" value="pos_emb: [2048, 896]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-120" y="240" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-26" value="rearrange" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-160" y="300" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-27" target="Xp7Y2SF31okqukY9dUAG-29">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-27" value="pos_emb: [1, 2048, 896]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-120" y="360" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-29" target="Xp7Y2SF31okqukY9dUAG-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-29" value="add" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-70" y="440" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-43" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-32" target="Xp7Y2SF31okqukY9dUAG-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-32" value="embed: [2, 2048, 896]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-30" y="500" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-51" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-34" target="Xp7Y2SF31okqukY9dUAG-50">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-34" value="decoder:&lt;br&gt;encoder=encoder,&lt;br&gt;context_mask=mask,&lt;br&gt;encoder_retrieved_mask=encoder_retrieved_mask,&lt;br&gt;retrieved=retrieved" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-107" y="680" width="270" height="210" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-35" target="Xp7Y2SF31okqukY9dUAG-36">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-35" value="rearrange" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="350" y="300" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-36" target="Xp7Y2SF31okqukY9dUAG-34">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-36" value="encoder_retrieved_mask:[2*32*2, 128]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="350" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-39" target="Xp7Y2SF31okqukY9dUAG-40">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-39" value="Linear: 896-&amp;gt;796" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-70" y="560" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-46" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-40" target="Xp7Y2SF31okqukY9dUAG-34">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-40" value="embed: [2, 2048, 796]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-32" y="610" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-53" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-50" target="Xp7Y2SF31okqukY9dUAG-52">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-50" value="embed: [?]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-32" y="920" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-55" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-52" target="Xp7Y2SF31okqukY9dUAG-54">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-52" value="Linear: ？-&amp;gt;796" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-72" y="990" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-54" value="logits: [?]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-32" y="1040" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-123" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-56" target="Xp7Y2SF31okqukY9dUAG-120">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1610" y="100" />
              <mxPoint x="1610" y="660" />
              <mxPoint x="1443" y="660" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-139" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-56" target="Xp7Y2SF31okqukY9dUAG-132">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-56" value="embed: [2, 2048, 796]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1630" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-63" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-57" target="Xp7Y2SF31okqukY9dUAG-58">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-57" value="arrange(32)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1000" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-65" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-58" target="Xp7Y2SF31okqukY9dUAG-59">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-58" value="1/(10000^(x/32))" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1000" y="140" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-67" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-59" target="Xp7Y2SF31okqukY9dUAG-62">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1060" y="250" />
              <mxPoint x="1120" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-117" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-59" target="Xp7Y2SF31okqukY9dUAG-91">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1060" y="250" />
              <mxPoint x="1271" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-118" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-59" target="Xp7Y2SF31okqukY9dUAG-105">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1060" y="250" />
              <mxPoint x="1420" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-59" value="inv_freq: [16]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1000" y="200" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-64" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-60" target="Xp7Y2SF31okqukY9dUAG-61">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-60" value="arrange(2048)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1170" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-66" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-61" target="Xp7Y2SF31okqukY9dUAG-62">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-61" value="seq: [2048]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1170" y="140" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-70" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-62" target="Xp7Y2SF31okqukY9dUAG-68">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-62" value="enisum(i, j -&amp;gt; i j)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1090" y="270" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-71" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-68" target="Xp7Y2SF31okqukY9dUAG-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-68" value="freqs: [2048, 16]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1090" y="330" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-73" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-69" target="Xp7Y2SF31okqukY9dUAG-72">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-69" value="concat" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1090" y="390" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-76" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-72" target="Xp7Y2SF31okqukY9dUAG-74">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-72" value="freqs: [2048, 32]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1090" y="450" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-77" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-74" target="Xp7Y2SF31okqukY9dUAG-75">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-74" value="rearrange" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1090" y="510" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-122" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-75" target="Xp7Y2SF31okqukY9dUAG-120">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-75" value="attn_embed: [1, 1, 2048, 32]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1090" y="570" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-87" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-88" target="Xp7Y2SF31okqukY9dUAG-89">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-88" value="arrange(64) + 63" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1320.5" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-115" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-89" target="Xp7Y2SF31okqukY9dUAG-91">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-89" value="seq: [64]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1320.5" y="140" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-90" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-91" target="Xp7Y2SF31okqukY9dUAG-93">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-91" value="enisum(i, j -&amp;gt; i j)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1240.5" y="270" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-92" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-93" target="Xp7Y2SF31okqukY9dUAG-95">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-93" value="freqs: [64, 16]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1240.5" y="330" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-94" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-95" target="Xp7Y2SF31okqukY9dUAG-97">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-95" value="concat" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1240.5" y="390" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-96" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-97" target="Xp7Y2SF31okqukY9dUAG-99">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-97" value="freqs: [64, 32]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1240.5" y="450" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-98" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-99" target="Xp7Y2SF31okqukY9dUAG-100">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-99" value="rearrange" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1240.5" y="510" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-148" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-100" target="Xp7Y2SF31okqukY9dUAG-126">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1301" y="650" />
              <mxPoint x="1390" y="650" />
              <mxPoint x="1390" y="830" />
              <mxPoint x="1443" y="830" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-100" value="q_embed: [1, 1, 64, 32]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1240.5" y="570" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-101" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-102" target="Xp7Y2SF31okqukY9dUAG-103">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-102" value="arrange(128)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1470" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-116" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-103" target="Xp7Y2SF31okqukY9dUAG-105">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-103" value="seq: [128]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1470" y="140" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-104" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-105" target="Xp7Y2SF31okqukY9dUAG-107">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-105" value="enisum(i, j -&amp;gt; i j)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1390" y="270" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-106" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-107" target="Xp7Y2SF31okqukY9dUAG-109">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-107" value="freqs: [128, 16]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1390" y="330" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-108" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-109" target="Xp7Y2SF31okqukY9dUAG-111">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-109" value="concat" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1390" y="390" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-110" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-111" target="Xp7Y2SF31okqukY9dUAG-113">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-111" value="freqs: [128, 32]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1390" y="450" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-112" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-113" target="Xp7Y2SF31okqukY9dUAG-114">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-113" value="rearrange" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1390" y="510" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-149" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-114" target="Xp7Y2SF31okqukY9dUAG-126">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1450" y="630" />
              <mxPoint x="1570" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-114" value="k_embed: [1, 1, 128, 32]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1390" y="570" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-125" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-120" target="Xp7Y2SF31okqukY9dUAG-124">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-120" value="attention" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="750" width="510" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-121" value="Repeat decode depth times" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="900" y="710" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-127" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-124" target="Xp7Y2SF31okqukY9dUAG-126">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-124" value="x: [?]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1255" y="800" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-155" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-126" target="Xp7Y2SF31okqukY9dUAG-154">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-126" value="for layer 3, 6, 9, 12: cross_attention&lt;br&gt;context = retrieved,&lt;br&gt;context_mask = mask,&lt;br&gt;pos_emb=(q_embed, k_embed)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="850" width="510" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-130" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-128" target="Xp7Y2SF31okqukY9dUAG-129">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-128" value="retrieved: [2, 32, 2, 128, 896]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1770" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-141" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-129" target="Xp7Y2SF31okqukY9dUAG-131">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-129" value="rearrange" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1770" y="140" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-131" value="retrieved: [2*32*2, 128, 896]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1770" y="200" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-140" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-132" target="Xp7Y2SF31okqukY9dUAG-133">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-132" value="repeat" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1630" y="140" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-138" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-133" target="Xp7Y2SF31okqukY9dUAG-135">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-133" value="seq_as_context:[2*2048/64*2, 64, 796]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1630" y="200" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-136" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-134" target="Xp7Y2SF31okqukY9dUAG-135">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-134" value="encoder_retrieved_mask:&lt;br&gt;[2*32*2, 128]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1910" y="80" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-143" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-135" target="Xp7Y2SF31okqukY9dUAG-142">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-135" value="encoder" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1768" y="280" width="290" height="220" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-137" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-131" target="Xp7Y2SF31okqukY9dUAG-135">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1830" y="250" />
              <mxPoint x="1913" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-145" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-142" target="Xp7Y2SF31okqukY9dUAG-144">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-142" value="retrieved: [? , ?, ?]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1853" y="530" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-147" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-144" target="Xp7Y2SF31okqukY9dUAG-146">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-144" value="rearrange" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1853" y="590" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-150" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-146" target="Xp7Y2SF31okqukY9dUAG-126">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-146" value="retrieved: [?, 32, 2 , ?, ?]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1853" y="650" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-153" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-151" target="Xp7Y2SF31okqukY9dUAG-126">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-151" value="mask: [2, 32, 2, 128]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="2080" y="80" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-157" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-154" target="Xp7Y2SF31okqukY9dUAG-156">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-154" value="x: [?]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1255" y="940" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-159" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Xp7Y2SF31okqukY9dUAG-156" target="Xp7Y2SF31okqukY9dUAG-158">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-156" value="feed forward" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1058" y="990" width="510" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Xp7Y2SF31okqukY9dUAG-158" value="x: [?]" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1253" y="1040" width="120" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
